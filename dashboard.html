<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard - View Menus</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Arial', sans-serif;
      background-color: #f4f7fb;
      color: #333;
      line-height: 1.6;
    }
    .container {
      max-width: 1000px;
      margin: 50px auto;
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      padding: 20px;
      overflow: hidden;
    }
    h2 {
      text-align: center;
      margin-bottom: 20px;
      font-size: 1.8em;
      color: #333;
    }
    .category {
      margin-top: 30px;
    }
    .category h3 {
      color: #0078d7;
      font-size: 1.5em;
      margin-bottom: 15px;
    }
    .menu-list {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 20px;
    }
    .menu-item {
      background: #f9f9f9;
      border-radius: 10px;
      padding: 15px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      transition: box-shadow 0.3s ease;
      text-align: center;
      cursor: pointer;
    }
    .menu-item:hover {
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
    }
    .menu-item h4 {
      font-size: 1.2em;
      margin-bottom: 10px;
      color: #333;
    }
    .menu-item p {
      font-size: 0.9em;
      color: #555;
    }
    .menu-item.selected {
      background-color: #a5d8ff;
      border: 2px solid #0078d7;
    }
    .menu-item .date {
      font-size: 0.8em;
      color: #999;
      margin-top: 10px;
    }
    .date-container {
      text-align: right;
      font-size: 1.2em;
      color: #555;
      margin-top: 20px;
    }
    .add-menu-btn {
      display: block;
      margin: 20px auto;
      background-color: #0078d7;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      text-align: center;
      font-size: 1.1em;
      text-decoration: none;
    }
    .add-menu-btn:hover {
      background-color: #005fa3;
    }
    .recommendation-container {
      margin-top: 30px;
      padding: 15px;
      background-color: #f1f1f1;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
    .recommendation-container h3 {
      color: #0078d7;
      font-size: 1.5em;
      margin-bottom: 15px;
    }
    .recommendation-item {
      background: #ffffff;
      border-radius: 10px;
      padding: 15px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>Your Menu Dashboard</h2>
    
    <!-- Today's Recommendation Section -->
    <div class="recommendation-container" id="recommendationContainer">
      <h3>Today's Recommendation</h3>
      <div id="recommendationList" class="menu-list"></div>
    </div>

    <div class="category" id="homeDishes">
      <h3>Cook at Home</h3>
      <div class="menu-list" id="homeList"></div>
    </div>

    <div class="category" id="orderDishes">
      <h3>Order from Outside</h3>
      <div class="menu-list" id="orderList"></div>
    </div>

    <div class="date-container" id="currentDate"></div>

    <!-- Add Menu Button -->
    <a href="addDish.html" class="add-menu-btn">Add Menu</a>
  </div>

  <script>

document.addEventListener("DOMContentLoaded", () => {
  const user = JSON.parse(localStorage.getItem("user"));
  const dishes = JSON.parse(localStorage.getItem("dishes")) || [];

  if (user) {
    alert(`Welcome, ${user.name}!`);
    
    // Prompt user to add dishes if no dishes exist
    if (dishes.length === 0) {
      alert("You don't have any dishes yet. Let's add some!");
      window.location.href = "addDish.html";
    }
  } else {
    // Redirect to sign-up page if no user is logged in
    window.location.href = "index.html";
  }

  // Render the rest of the dashboard (as implemented earlier)
});

    // Get the current date in the present calendar format
    const currentDate = new Date();
    const formattedDate = currentDate.toLocaleDateString('en-US', {
      year: 'numeric',
      month: 'long',
      day: 'numeric'
    });

    // Display the current date at the top right of the page
    document.getElementById("currentDate").textContent = `Today's Date: ${formattedDate}`;

    // Retrieve dishes from localStorage
    const dishes = JSON.parse(localStorage.getItem("dishes")) || [];
    const homeList = document.getElementById("homeList");
    const orderList = document.getElementById("orderList");
    const recommendationList = document.getElementById("recommendationList");

    // Display dishes on the dashboard
    if (dishes.length === 0) {
      homeList.innerHTML = "<p>No dishes added yet.</p>";
      orderList.innerHTML = "<p>No dishes added yet.</p>";
    } else {
      dishes.forEach(dish => {
        // Create a new menu item element
        const dishElement = document.createElement("div");
        dishElement.classList.add("menu-item");

        // Add the dish to the appropriate section (Cook at Home or Order from Outside)
        dishElement.innerHTML = `
          <h4>${dish.dishName}</h4>
        `;

        // Attach an event listener to each dish to select it for the day
        dishElement.addEventListener("click", () => {
          // Remove the 'selected' class from all other menu items
          const allMenuItems = document.querySelectorAll(".menu-item");
          allMenuItems.forEach(item => item.classList.remove("selected"));

          // Mark the clicked dish as selected
          dishElement.classList.add("selected");

          // Store the selected dish for the day (in localStorage, or other preferred storage)
          localStorage.setItem("selectedDish", dish.dishName);
        });

        if (dish.menuType === 'home') {
          homeList.appendChild(dishElement);
        } else {
          orderList.appendChild(dishElement);
        }
      });
    }

    // Function to generate today's recommendation
    function generateRecommendation() {
      const selectedDish = localStorage.getItem("selectedDish");
      let filteredDishes = dishes.filter(dish => dish.dishName !== selectedDish); // Exclude the selected dish for today
      const recommendationCount = Math.min(2, filteredDishes.length); // Randomly select 1 or 2 dishes

      // Shuffle dishes for randomness
      filteredDishes = filteredDishes.sort(() => Math.random() - 0.5);

      const recommendationItems = filteredDishes.slice(0, recommendationCount);

      recommendationList.innerHTML = ""; // Clear previous recommendations
      recommendationItems.forEach(dish => {
        const dishElement = document.createElement("div");
        dishElement.classList.add("recommendation-item");

        dishElement.innerHTML = `
          <h4>${dish.dishName}</h4>
          <p>${dish.menuType === 'home' ? 'Cook at Home' : 'Order from Outside'}</p>
        `;

        recommendationList.appendChild(dishElement);
      });
    }

    // Generate today's recommendation
    generateRecommendation();

    // Automatically reset the selected dish at the end of the day
    setInterval(() => {
      const currentDay = new Date().getDate();
      const storedDate = localStorage.getItem("currentDay");

      if (currentDay !== Number(storedDate)) {
        localStorage.removeItem("selectedDish");
        const selectedDish = document.querySelector(".menu-item.selected");
        if (selectedDish) {
          selectedDish.classList.remove("selected");
        }
        localStorage.setItem("currentDay", currentDay);
      }
    }, 1000 * 60 * 60 * 24);  // Check every 24 hours
  </script>
</body>
</html>
